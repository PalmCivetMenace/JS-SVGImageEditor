<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JS-SVG Image Editor</title>
    <script
    src="https://code.jquery.com/jquery-3.1.1.min.js"
    integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
    crossorigin="anonymous"></script>

    <script src="../src/draw.svg.js"></script>
    <script src="../src/draw.svg.editor.js"></script>
    <script src="../src/draw.svg.data-constructor.js"></script>
    <script src="js/jscolor.min.js"></script>

    <link rel="stylesheet" type="text/css" href="css/style.editor.css">
    <link rel="stylesheet" type="text/css" href="css/radio-style.css">
    <link rel="stylesheet" type="text/css" href="css/marker-style.css">
    <link rel="stylesheet" type="text/css" href="css/json-style.css">

    <script src="js/jquery.mousewheel.min.js"></script>

</head>
<body>
<div class="zoom-panel">
    <button class="zoom-btn zoom-svg-in" title="Zoom-in">+</button>
    <button class="zoom-btn zoom-svg-out" title="Zoom-out">-</button>
</div>

<div class="json-management-panel">
    <button id="generateJson">Generate JSON</button>

    <div id="generate_json_block">
        <button>Generate from JSON</button>

        <div id="json_input_block">
            <textarea name="json_input" id="json_input" cols="30" rows="10"></textarea>
            <button id="generateFromJson">Generate</button>
        </div>
    </div>
</div>

<div class="control-panel">
    <form id="select-item">
        Color: <input class="jscolor" value="29AB22" name="strokeColor">
        <div class="radio-tab">
            <div class="radio-figure">
                <label for="rectangle-radio">
                    <input id="rectangle-radio" type="radio" value="rectangle" name="item" checked>
                    <img class="brush-preview" src="images/editor/rectangle.jpg" title="Rectangle">
                </label>
            </div>
            <div class="radio-figure">
                <label for="arrow-radio">
                    <input id="arrow-radio" type="radio" value="arrow" name="item">
                    <img class="brush-preview" src="images/editor/arrow.jpg" title="Arrow">
                </label>
            </div>
            <div class="radio-figure">
                <label for="line-radio">
                    <input id="line-radio" type="radio" value="line" name="item">
                    <img class="brush-preview" src="images/editor/line.jpg" title="Line">
                </label>
            </div>
            <div class="radio-figure">
                <label for="ellipse-radio">
                    <input id="ellipse-radio" type="radio" value="ellipse" name="item">
                    <img class="brush-preview" src="images/editor/ellipse.jpg" title="Ellipse">
                </label>
            </div>
            <div class="radio-figure">
                <label for="eraser-radio">
                    <input id="eraser-radio" type="radio" value="eraser" name="item">
                    <img class="brush-preview" src="images/editor/eraser.jpg" title="Eraser">
                </label>
            </div>
            <div class="radio-figure">
                <label for="drag-radio">
                    <input id="drag-radio" type="radio" value="drag" name="item" >
                    <img class="brush-preview" src="images/editor/drag.jpg" title="Drag">
                </label>
            </div>
            <div class="radio-figure">
                <label for="marker-radio">
                    <input id="marker-radio" type="radio" value="marker" name="item" >
                    <img class="brush-preview" src="images/editor/marker.jpg" title="Drag">
                </label>
            </div>
        </div>
    </form>
    <button id="initImage">initializeIMG</button>
    <p><b id="current-pos">(X;Y)</b></p>
    
</div>

<div id="svg-editor-area">
    <div id="svg-work-area">
        <div id="svg-image-couple">
            <svg id="svg-area">
            </svg>
            <div id="bg-element">
                <img id="bg-element-image" src="" alt="image not loaded">
            </div>
        </div>
    </div>
</div>


</body>

<script>
/*
    Components initialization.
*/
drawSVG.init('svg-area');
svgEditor.init('svg-work-area', 'svg-area', 'bg-element');
</script>

<script>
/*
    Ui interaction code
*/
var selectedItem = $('input[name=item]:checked', '#select-item').val();
var strokeColor = $('input[name=strokeColor]', '#select-item').val();

$('#select-item').change(function(){
    selectedItem = $('input[name=item]:checked', '#select-item').val();
    strokeColor = $('input[name=strokeColor]', '#select-item').val();
});

</script>

<script>
$('#generateFromJson').click(function(){

    function isJSON(str) {
        try {
            JSON.parse(str);
        } catch (e) {
            return false;
        }
        return true;
    }

    json_string = $('#json_input').val();

    if(!isJSON(json_string))
    {
        alert ('JSON is not valid');
    }
    else
    {
        dataConstructor.generateElementsObjFromJson(drawSVG, json_string);
    }
    
});

$('#generateJson').click(function(){

    generated_json = dataConstructor.generateJSON();
    $('#json_input').val(generated_json);
    $('#generate_json_block').click();

});
    
</script>

<script src="../src/editor.js"></script>

</html>
